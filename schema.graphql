type FounderInfo @entity {
  id: ID!
  ownershipPercentage: BigInt!
  vestExpiry: BigInt!

  tokenContract: TokenContract!
  account: Account!
}

type DAO @entity {
  id: ID! # `DAO-${tokenContractAddress}`
  # token Info
  tokenContract: TokenContract! @derivedFrom(field: "DAO")
  # tokenAddress: Bytes!

  # auction Info
  auctionContract: AuctionContract! @derivedFrom(field: "DAO")
  # auctionAddress: Bytes!

  # metadata Info
  metadataContract: MetadataContract! @derivedFrom(field: "DAO")
  # metadataAddress: Bytes!

  # governor Info
  governorContract: GovernorContract! @derivedFrom(field: "DAO")
  # governorAddress: Bytes!

  # treasury Info
  treasuryContract: TreasuryContract! @derivedFrom(field: "DAO")
  # treasuryAddress: Bytes!
}

type TokenContract @entity {
  id: ID! # address
  name: String!
  symbol: String!
  totalSupply: BigInt!
  contractURI: String!

  founders: [FounderInfo!]! @derivedFrom(field: "tokenContract")
  DAO: DAO!
  tokens: [Token!]! @derivedFrom(field: "tokenContract")
}

type Token @entity {
  id: ID! # tokenAddress + tokenId
  tokenId: BigInt!
  tokenURI: String!

  tokenContract: TokenContract!
  auction: Auction!
  owner: Account!
}

type AuctionContract @entity {
  id: ID! # address
  duration: BigInt!
  reservePrice: BigInt!
  timeBuffer: BigInt!
  minBidIncrement: BigInt!
  paused: Boolean!

  DAO: DAO!
  auctions: [Auction!]! @derivedFrom(field: "auctionContract") # daily (or other interval) auctions
}

type Auction @entity {
  id: ID! # address + tokenId
  settled: Boolean!
  startTime: BigInt! # uint256
  endTime: BigInt! # uint256
  winner: Account # address
  auctionContract: AuctionContract!
  bids: [AuctionBid!]! @derivedFrom(field: "auction")
  token: Token!
}

type AuctionBid @entity(immutable: true) {
  id: ID! # txHash
  amount: BigInt! # uint256
  extended: Boolean! # bool
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!

  auction: Auction!
  bidder: Account!
}

type Delegation @entity {
  id: ID! # account address + dao address
  DAO: DAO!
  voter: Account!
  delegatedTo: Account!
}

type Account @entity {
  id: ID! # address
  bids: [AuctionBid!]! @derivedFrom(field: "bidder")
  tokens: [Token!]! @derivedFrom(field: "owner")
  votes: [Vote!]! @derivedFrom(field: "voter")
  submittedProposals: [Proposal!]! @derivedFrom(field: "submitter")

  delegations: [Delegation!]! @derivedFrom(field: "voter")
  delegatedBy: [Delegation!]! @derivedFrom(field: "delegatedTo")
}

type MetadataContract @entity {
  id: ID! # address
  websiteURL: String! # projectURI
  description: String!
  contractImage: String!
  rendererBase: String!

  DAO: DAO!
}

type TreasuryTransaction @entity {
  id: ID!
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!

  treasuryContract: TreasuryContract!
  proposal: Proposal!
}

type TreasuryContract @entity {
  id: ID! # address
  delay: BigInt!
  gracePeriod: BigInt!

  DAO: DAO!
  transactions: [TreasuryTransaction!]! @derivedFrom(field: "treasuryContract")
}

type GovernorContract @entity {
  id: ID! # address
  vetoEnabled: Boolean!
  vetoerAddress: Bytes!
  proposalThreshold: BigInt! # bps
  quoromThreshold: BigInt! # bps
  votingDelay: BigInt!
  votingPeriod: BigInt!

  DAO: DAO!
}

enum ProposalStatus {
  PENDING
  ACTIVE
  CANCELLED
  VETOED
  QUEUED
  EXECUTED
}

type Proposal @entity {
  id: ID!
  description: String!
  descriptionHash: Bytes!
  status: ProposalStatus!
  targets: [Bytes!]!
  values: [BigInt!]!
  calldatas: [Bytes!]!

  forVotes: BigInt!
  againstVotes: BigInt!
  abstainVotes: BigInt!
  votes: [Vote!]! @derivedFrom(field: "proposal")

  submitter: Account!
  transaction: TreasuryTransaction
}

enum VoteType {
  FOR
  AGAINST
  ABSTAIN
}

type Vote @entity {
  id: ID!
  supported: VoteType!
  reason: String

  proposal: Proposal!
  voter: Account!
  delegate: Account
}
